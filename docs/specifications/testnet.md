
<h1 align="center">Ontology </h1>
<p align="center" class="version">Version 1.0.0 </p>

[![GoDoc](https://godoc.org/github.com/ontio/ontology?status.svg)](https://godoc.org/github.com/ontio/ontology)
[![Go Report Card](https://goreportcard.com/badge/github.com/ontio/ontology)](https://goreportcard.com/report/github.com/ontio/ontology)
[![Travis](https://travis-ci.org/ontio/ontology.svg?branch=master)](https://travis-ci.org/ontio/ontology)
[![Gitter](https://badges.gitter.im/Join%20Chat.svg)](https://gitter.im/ontio/ontology?utm_source=badge&utm_medium=badge&utm_campaign=pr-badge)

English | [中文](testnet_CN.md) 

## Server deployment
### Select network
To run Ontology successfully,  nodes can be deployed by four ways:

- Mainnet sync node deployment
- Public test network(Polaris) sync node deployment
- Single-host deployment
- Multi-hosts deployment

#### Mainnet sync node deployment

Run ontology straightly

   ```
	./ontology --networkid 1
   ```

#### Public test network(Polaris) sync node deployment   
     
Run ontology straightly

   ```
	./ontology --networkid 2
   ```

#### Single-host deployment configuration

Create a directory on the host and store the following files in the directory:

- Node program + Node control program  `ontology`
- Wallet file`wallet.dat`.

Here's a example of single-host configuration:

- Directory structure
    ```shell
    $ tree
    └── ontology
        ├── ontology
        └── wallet.dat
    ```

Run ontology

   ```
	./ontology --testmode --networkid 3
   ```
#### Multi-hosts deployment configuration

Note: When you want to build a private net to run ontology in DBFT or VBFT, you must use --config argument to specify a configuration file, and
use --networkid to define a net work identity of your network(not equals 1/2/3), otherwise the node will link to mainnet by default.

##### VBFT Deployment

In the multi-hosts enviroment, we need 7 nodes to run ontology at least in VBFT.

We can perform a quick deployment by modifying the configuration file [`config-vbft.json`](config-vbft.json), click [here](config.md) to read 
instruction of config file.

1. Generate 7 wallet file, each wallet contains an account. These account is bookkeepers of consensus. The account generated by :
	```
	./ontology account add -d -w wallet.dat
	Use default setting '-t ecdsa -b 256 -s SHA256withECDSA' 
		signature algorithm: ecdsa 
		curve: P-256 
		signature scheme: SHA256withECDSA 
	Password:
	Re-enter Password:

	Index: 1
	Label: 
	Address: AXkDGfr9thEqWmCKpTtQYaazJRwQzH48eC
	Public key: 03d7d8c0c4ca2d2bc88209db018dc0c6db28380d8674aff86011b2a6ca32b512f9
	Signature scheme: SHA256withECDSA

	Create account successfully.
	```
    use -w argument to define wallet file name

2. Modify `config-vbft.json`, set public key and address of 7 accounts generated in last step into peers config in `config-vbft.json`.

3. Copy related file into target host, including:

   - A configuration file`config-vbft.json`
   - Node program`ontology`
   - wallet file
   
4. Set the network connection port number for each node (recommend using the default port configuration, instead of modifying)

   - `NodePort`is P2P connection port number (default: 20338)
   - `HttpJsonPort` and `HttpLocalPort` are RPC port numbers (default: 20336, 20337)

5. Seed nodes configuration

   - Select at least one seed node out of 7 hosts and fill the seed node address into the `SeelList` of each configuration file. The format is `Seed node IP address + Seed node NodePort`.

##### DBFT Deployment

In the multi-hosts enviroment, we need 4 nodes to run ontology at least in DBFT.

We can perform a quick deployment by modifying the configuration file [`config-dbft.json`](config-dbft.json), click [here](config.md) to read 
 instruction of config file.
1. Copy related file into target host, including:
  
     - Configuration file`config-dbft.json`
     - Node program`ontology`
     
2. Set the network connection port number for each node (recommend using the default port configuration, instead of modifying)

   - `NodePort`is P2P connection port number (default: 20338)
   - `HttpJsonPort` and `HttpLocalPort` are RPC port numbers (default: 20336, 20337)

3. Seed nodes configuration
   
      - Select at least one seed node out of 4 hosts and fill the seed node address into the `SeelList` of each configuration file. The format is `Seed node IP address + Seed node NodePort`.

4. Create wallet file

   - Through command line program, on each host create wallet wallet.dat needed for node implementation.
        ```
        ./ontology account add -d -w wallet.dat
        Use default setting '-t ecdsa -b 256 -s SHA256withECDSA' 
        signature algorithm: ecdsa 
        curve: P-256 
        signature scheme: SHA256withECDSA 
        Password:
        Re-enter Password:
            
        Index: 1
        Label: 
        Address: AXkDGfr9thEqWmCKpTtQYaazJRwQzH48eC
        Public key: 03d7d8c0c4ca2d2bc88209db018dc0c6db28380d8674aff86011b2a6ca32b512f9
        Signature scheme: SHA256withECDSA
            
        Create account successfully.
        ```

5. Bookkeepers configuration

   - While creating a wallet for each node, the public key information of the wallet will be displayed. Fill in the public key information of all nodes in the `Bookkeepers` field of each node's configuration file.

     Note: The public key information for each node's wallet can also be viewed via the command line program:

        ```
        1	AYiToLDT2yZuNs3PZieXcdTpyC5VWQmfaN (default)
        	Label: 
        	Signature algorithm: ECDSA
        	Curve: P-256
        	Key length: 384 bits
        	Public key: 030e5d50bf585ff5c73464114244b93f04b231862d6bbdfd846be890093b2c1c17
        	Signature scheme: SHA256withECDSA
        ```

#### Deploy Completed

Now multi-host configuration is completed, directory structure of each node is as follows:

   ```shell
	$ ls
	config.json ontology wallet.dat
   ```

### Implement

Run each node program in any order and enter the node's wallet password after the `Password:` prompt appears.
  
If you wish to run a consensus node (such as in a private net), the --enableconsensus argument must be used. If you want to run
a private net, use --networkid argument to specify your net work identify（not equals 1/2/3） and use --config argument to specify your configuration
file.

such as:
   ```
    $ ./ontology --enableconsensus --networkid 4 --config ./config.json
    $ - Input your wallet password
   ```

Run `./ontology --help` for details, also you can read [ontology CLI user guide](cli_user_guide.md) to get more information.

### ONT transfer sample
--asset: asset type ["ont"|"ong"] ； - from: transfer from； - to: transfer to； - amount: amount；
```shell
  ./ontology asset transfer --amount=500 --from  AYiToLDT2yZuNs3PZieXcdTpyC5VWQmfaN  --to AeoBhZtS8AmGp3Zt4LxvCqhdU4eSGiK44M
```
If transfer asset successd, the result will show as follow:
```
Transfer ONT
  From:AYiToLDT2yZuNs3PZieXcdTpyC5VWQmfaN
  To:AeoBhZtS8AmGp3Zt4LxvCqhdU4eSGiK44M
  Amount:1
  TxHash:d232bf1c876fc6fd2f8be90006e523897b1e2082e6df8f08466c56985d24a2a7

Tip:
  Using './ontology info status d232bf1c876fc6fd2f8be90006e523897b1e2082e6df8f08466c56985d24a2a7' to query transaction status
```